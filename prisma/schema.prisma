// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  timezone  String   @default("UTC")
  theme     String   @default("light")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  dailyPlans  DailyPlan[]
  sessions    Session[]

  @@map("users")
}

model Session {
  id        String   @id @default(cuid())
  userId    String
  expiresAt DateTime
  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("sessions")
}

model DailyPlan {
  id       String   @id @default(cuid())
  userId   String
  planDate DateTime @db.Date
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user            User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  deepWorkZones   DeepWorkZone[]
  quickWins       QuickWin[]
  makeItHappens   MakeItHappen[]
  rechargeZones   RechargeZone[]
  littleJoys      LittleJoy[]
  reflectionToday ReflectionToday?
  focusTomorrow   FocusTomorrow?

  @@unique([userId, planDate])
  @@map("daily_plans")
}

model DeepWorkZone {
  id        String   @id @default(cuid())
  planId    String
  title     String
  timeEstimate Int?
  notes     String?
  completed Boolean  @default(false)
  completedAt DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  plan DailyPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@map("deep_work_zones")
}

model QuickWin {
  id        String   @id @default(cuid())
  planId    String
  title     String
  completed Boolean  @default(false)
  completedAt DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  plan DailyPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@map("quick_wins")
}

model MakeItHappen {
  id        String   @id @default(cuid())
  planId    String
  task      String
  completed Boolean  @default(false)
  completedAt DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  plan DailyPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@map("make_it_happen")
}

model RechargeZone {
  id        String   @id @default(cuid())
  planId    String
  activityId String?
  customActivity String?
  completed Boolean  @default(false)
  completedAt DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  plan DailyPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@map("recharge_zones")
}

model LittleJoy {
  id        String   @id @default(cuid())
  planId    String
  content   String
  createdAt DateTime @default(now())

  plan DailyPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@map("little_joys")
}

model ReflectionToday {
  id        String   @id @default(cuid())
  planId    String   @unique
  content   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  plan DailyPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@map("reflections_today")
}

model FocusTomorrow {
  id        String   @id @default(cuid())
  planId    String   @unique
  content   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  plan DailyPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@map("focus_tomorrow")
}
